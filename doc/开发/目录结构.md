# 项目目录结构（规划）

## 设计原则

**按系统版本区分脚本目录**，避免在单个 Python/Shell 脚本中做复杂的多系统兼容判断。

- 每个系统版本有独立的组件脚本目录
- `install.sh` 负责检测系统版本并调用对应目录的脚本
- 新增系统支持只需添加新目录，不影响现有代码

---

## 目录结构

```
deploy/
├── install.sh                 # 统一入口（检测系统、调用对应版本）
├── lib/
│   └── common.sh              # 公共函数库（日志、错误处理）
│
├── scripts/
│   ├── debian12/              # Debian 12 专用脚本
│   │   ├── system.sh
│   │   ├── network.sh
│   │   ├── packages.sh
│   │   ├── php.sh
│   │   ├── openresty.sh
│   │   ├── mysql.sh
│   │   ├── redis.sh
│   │   ├── fail2ban.sh
│   │   └── firewall.sh
│   │
│   ├── debian11/              # Debian 11（预留）
│   │   └── ...
│   │
│   └── ubuntu2204/            # Ubuntu 22.04（预留）
│       └── ...
│
├── config/
│   ├── components.conf        # 组件配置（端口、路径等）
│   └── versions.conf          # 软件版本号配置
│
├── doc/
│   └── 开发/
│       ├── 需求文档.md
│       ├── 组件清单.md
│       └── 目录结构.md
│
└── README.md
```

---

## 脚本调用流程

```
用户执行: ./install.sh --mysql --redis --mode fast

         │
         ▼
    ┌─────────────┐
    │ install.sh  │  预检：root? 系统版本? 
    └─────────────┘
         │
         ▼ 检测到 Debian 12
    ┌─────────────────────────┐
    │ scripts/debian12/*.sh   │  执行对应组件脚本
    └─────────────────────────┘
         │
         ▼
    ┌─────────────┐
    │ 汇总报告    │  成功/失败统计
    └─────────────┘
```

---

## 运行时目录

```
/var/log/deploy/               # 日志目录
├── deploy-20251201.log        # 主日志
└── components/                # 组件日志
    ├── mysql.log
    ├── redis.log
    └── ...

/home/video/                   # 应用数据目录
└── uboy.cbo                   # MySQL 密码文件
```

---

## 扩展新系统

1. 在 `scripts/` 下创建新目录，如 `centos9/`
2. 复制 `debian12/` 的脚本作为模板
3. 修改包管理命令（apt → yum/dnf）
4. 在 `install.sh` 的系统检测中添加对应分支
