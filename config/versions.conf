# 软件版本配置
OPENRESTY_VERSION="1.27.1.2"
MYSQL_APT_CONFIG_VERSION="0.8.29-1"

# 路径配置
OPENRESTY_PREFIX="/usr/local/openresty"
DATA_DIR="/home/video"
LOG_DIR="/home/log"
WWWLOG_DIR="/home/wwwlogs"

# OpenResty 配置源（相对于脚本根目录）
OPENRESTY_CONF_SOURCE="conf"

# 开放端口列表
OPEN_PORTS="80 443 2000 2100 9971 5522 7711 2052"

# fail2ban 白名单 IP
FAIL2BAN_WHITELIST="127.0.0.1/8 ::1 104.156.251.208 23.224.183.227"

# PHP-FPM 配置 (针对 E5-2680 v4 14核 128GB内存优化)
# CPU: 14 cores (28 threads)
# Memory: 128GB
# 优化策略: 平衡性能和资源利用

# PHP 基础配置
PHP_UPLOAD_MAX="100M"
PHP_POST_MAX="100M"

# PHP-FPM 进程管理 (动态模式)
# 每个 PHP 进程平均内存占用约 64MB (保守估计)
# 总内存 128GB，预留 32GB 给系统 = 96GB 可用
# 96GB / 64MB = 1536 个进程 (理论最大值)
# 考虑 CPU 核心数限制: 14 cores * 8 = 112 个进程 (实际设置)
PHP_PM_MAX_CHILDREN="112"

# 启动时创建的子进程数
PHP_PM_START_SERVERS="28"

# 最少空闲进程数
PHP_PM_MIN_SPARE="14"

# 最多空闲进程数
PHP_PM_MAX_SPARE="56"

# 每个子进程处理的最大请求数 (防止内存泄漏)
PHP_PM_MAX_REQUESTS="4096"
